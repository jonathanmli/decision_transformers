Warning: Flow failed to import. Set the environment variable D4RL_SUPPRESS_IMPORT_ERROR=1 to suppress this message.
No module named 'flow'
INFO:absl:MUJOCO_GL is not set, so an OpenGL backend will be chosen automatically.
/home-nfs/doctorduality/mc3/envs/ml/lib/python3.9/site-packages/glfw/__init__.py:906: GLFWError: (65544) b'X11: The DISPLAY environment variable is missing'
  warnings.warn(message, GLFWError)
INFO:absl:Successfully imported OpenGL backend: glfw
INFO:absl:MuJoCo library version is: 210
Warning: CARLA failed to import. Set the environment variable D4RL_SUPPRESS_IMPORT_ERROR=1 to suppress this message.
No module named 'carla'
pybullet build time: Dec  1 2021 18:34:28
/share/data/mei-work/jolly/decision_transformers/sql/evaluation/DTevaluation.py:52: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1639180487213/work/torch/csrc/utils/tensor_new.cpp:201.)
  s = torch.tensor([env.reset()], dtype=self.dtype, device=self.device)
/share/data/mei-work/jolly/decision_transformers/sql/evaluation/DTevaluation.py:71: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  a = torch.cat((a, torch.tensor(action, dtype=self.dtype, device=self.device).reshape(1, -1)))
==================================================
Starting new experiment: hopper medium
2186 trajectories, 999906 timesteps found
Average return: 1422.06, std: 378.95
Max return: 3222.36, min: 315.87
==================================================
Train
Batch number 0
Batch number 1
Batch number 2
Batch number 3
Batch number 4
Batch number 5
Batch number 6
Batch number 7
Batch number 8
Batch number 9
Batch number 10
Batch number 11
Batch number 12
Batch number 13
Batch number 14
Batch number 15
Batch number 16
Batch number 17
Batch number 18
Batch number 19
Batch number 20
Batch number 21
Batch number 22
Batch number 23
Batch number 24
Batch number 25
Batch number 26
Batch number 27
Batch number 28
Batch number 29
Batch number 30
Batch number 31
Batch number 32
Batch number 33
Batch number 34
Batch number 35
Batch number 36
Batch number 37
Batch number 38
Batch number 39
Batch number 40
Batch number 41
Batch number 42
Batch number 43
Batch number 44
Batch number 45
Batch number 46
Batch number 47
Batch number 48
Batch number 49
Batch number 50
Batch number 51
Batch number 52
Batch number 53
Batch number 54
Batch number 55
Batch number 56
Batch number 57
Batch number 58
Batch number 59
Batch number 60
Batch number 61
Batch number 62
Batch number 63
Batch number 64
Batch number 65
Batch number 66
Batch number 67
Batch number 68
Batch number 69
Batch number 70
Batch number 71
Batch number 72
Batch number 73
Batch number 74
Batch number 75
Batch number 76
Batch number 77
Batch number 78
Batch number 79
Batch number 80
Batch number 81
Batch number 82
Batch number 83
Batch number 84
Batch number 85
Batch number 86
Batch number 87
Batch number 88
Batch number 89
Batch number 90
Batch number 91
Batch number 92
Batch number 93
Batch number 94
Batch number 95
Batch number 96
Batch number 97
Batch number 98
Batch number 99
Batch number 100
Batch number 101
Batch number 102
Batch number 103
Batch number 104
Batch number 105
Batch number 106
Batch number 107
Batch number 108
Batch number 109
Batch number 110
Batch number 111
Batch number 112
Batch number 113
Batch number 114
Batch number 115
Batch number 116
Batch number 117
Batch number 118
Batch number 119
Batch number 120
Batch number 121
Batch number 122
Batch number 123
Batch number 124
Batch number 125
Batch number 126
Batch number 127
Batch number 128
Batch number 129
Batch number 130
Batch number 131
Batch number 132
Batch number 133
Batch number 134
Batch number 135
Batch number 136
Batch number 137
Batch number 138
Batch number 139
Batch number 140
Batch number 141
Batch number 142
Batch number 143
Batch number 144
Batch number 145
Batch number 146
Batch number 147
Batch number 148
Batch number 149
Batch number 150
Batch number 151
Batch number 152
Batch number 153
Batch number 154
Batch number 155
Batch number 156
Batch number 157
Batch number 158
Batch number 159
Batch number 160
Batch number 161
Batch number 162
Batch number 163
Batch number 164
Batch number 165
Batch number 166
Batch number 167
Batch number 168
Batch number 169
Batch number 170
Batch number 171
Batch number 172
Batch number 173
Batch number 174
Batch number 175
Batch number 176
Batch number 177
Batch number 178
Batch number 179
Batch number 180
Batch number 181
Batch number 182
Batch number 183
Batch number 184
Batch number 185
Batch number 186
Batch number 187
Batch number 188
Batch number 189
Batch number 190
Batch number 191
Batch number 192
Batch number 193
Batch number 194
Batch number 195
Batch number 196
Batch number 197
Batch number 198
Batch number 199
Batch number 200
Batch number 201
Batch number 202
Batch number 203
Batch number 204
Batch number 205
Batch number 206
Batch number 207
Batch number 208
Batch number 209
Batch number 210
Batch number 211
Batch number 212
Batch number 213
Batch number 214
Batch number 215
Batch number 216
Batch number 217
Batch number 218
Batch number 219
Batch number 220
Batch number 221
Batch number 222
Batch number 223
Batch number 224
Batch number 225
Batch number 226
Batch number 227
Batch number 228
Batch number 229
Batch number 230
Batch number 231
Batch number 232
Batch number 233
Batch number 234
Batch number 235
Batch number 236
Batch number 237
Batch number 238
Batch number 239
Batch number 240
Batch number 241
Batch number 242
Batch number 243
Batch number 244
Batch number 245
Batch number 246
Batch number 247
Batch number 248
Batch number 249
Batch number 250
Batch number 251
Batch number 252
Batch number 253
Batch number 254
Batch number 255
Batch number 256
Batch number 257
Batch number 258
Batch number 259
Batch number 260
Batch number 261
Batch number 262
Batch number 263
Batch number 264
Batch number 265
Batch number 266
Batch number 267
Batch number 268
Batch number 269
Batch number 270
Batch number 271
Batch number 272
Batch number 273
Batch number 274
Batch number 275
Batch number 276
Batch number 277
Batch number 278
Batch number 279
Batch number 280
Batch number 281
Batch number 282
Batch number 283
Batch number 284
Batch number 285
Batch number 286
Batch number 287
Batch number 288
Batch number 289
Batch number 290
Batch number 291
Batch number 292
Batch number 293
Batch number 294
Batch number 295
Batch number 296
Batch number 297
Batch number 298
Batch number 299
Batch number 300
Batch number 301
Batch number 302
Batch number 303
Batch number 304
Batch number 305
Batch number 306
Batch number 307
Batch number 308
Batch number 309
Batch number 310
Batch number 311
Batch number 312
Batch number 313
Batch number 314
Batch number 315
Batch number 316
Batch number 317
Batch number 318
Batch number 319
Batch number 320
Batch number 321
Batch number 322
Batch number 323
Batch number 324
Batch number 325
Batch number 326
Batch number 327
Batch number 328
Batch number 329
Batch number 330
Batch number 331
Batch number 332
Batch number 333
Batch number 334
Batch number 335
Batch number 336
Batch number 337
Batch number 338
Batch number 339
Batch number 340
Batch number 341
Batch number 342
Batch number 343
Batch number 344
Batch number 345
Batch number 346
Batch number 347
Batch number 348
Batch number 349
Batch number 350
Batch number 351
Batch number 352
Batch number 353
Batch number 354
Batch number 355
Batch number 356
Batch number 357
Batch number 358
Batch number 359
Batch number 360
Batch number 361
Batch number 362
Batch number 363
Batch number 364
Batch number 365
Batch number 366
Batch number 367
Batch number 368
Batch number 369
Batch number 370
Batch number 371
Batch number 372
Batch number 373
Batch number 374
Batch number 375
Batch number 376
Batch number 377
Batch number 378
Batch number 379
Batch number 380
Batch number 381
Batch number 382
Batch number 383
Batch number 384
Batch number 385
Batch number 386
Batch number 387
Batch number 388
Batch number 389
Batch number 390
Batch number 391
Batch number 392
Batch number 393
Batch number 394
Batch number 395
Batch number 396
Batch number 397
Batch number 398
Batch number 399
Batch number 400
Batch number 401
Batch number 402
Batch number 403
Batch number 404
Batch number 405
Batch number 406
Batch number 407
Batch number 408
Batch number 409
Batch number 410
Batch number 411
Batch number 412
Batch number 413
Batch number 414
Batch number 415
Batch number 416
Batch number 417
Batch number 418
Batch number 419
Batch number 420
Batch number 421
Batch number 422
Batch number 423
Batch number 424
Batch number 425
Batch number 426
Batch number 427
Batch number 428
Batch number 429
Batch number 430
Batch number 431
Batch number 432
Batch number 433
Batch number 434
Batch number 435
Batch number 436
Batch number 437
Batch number 438
Batch number 439
Batch number 440
Batch number 441
Batch number 442
Batch number 443
Batch number 444
Batch number 445
Batch number 446
Batch number 447
Batch number 448
Batch number 449
Batch number 450
Batch number 451
Batch number 452
Batch number 453
Batch number 454
Batch number 455
Batch number 456
Batch number 457
Batch number 458
Batch number 459
Batch number 460
Batch number 461
Batch number 462
Batch number 463
Batch number 464
Batch number 465
Batch number 466
Batch number 467
Batch number 468
Batch number 469
Batch number 470
Batch number 471
Batch number 472
Batch number 473
Batch number 474
Batch number 475
Batch number 476
Batch number 477
Batch number 478
Batch number 479
Batch number 480
Batch number 481
Batch number 482
Batch number 483
Batch number 484
Batch number 485
Batch number 486
Batch number 487
Batch number 488
Batch number 489
Batch number 490
Batch number 491
Batch number 492
Batch number 493
Batch number 494
Batch number 495
Batch number 496
Batch number 497
Batch number 498
Batch number 499
Batch number 500
Batch number 501
Batch number 502
Batch number 503
Batch number 504
Batch number 505
Batch number 506
Batch number 507
Batch number 508
Batch number 509
Batch number 510
Batch number 511
Batch number 512
Batch number 513
Batch number 514
Batch number 515
Batch number 516
Batch number 517
Batch number 518
Batch number 519
Batch number 520
Batch number 521
Batch number 522
Batch number 523
Batch number 524
Batch number 525
Batch number 526
Batch number 527
Batch number 528
Batch number 529
Batch number 530
Batch number 531
Batch number 532
Batch number 533
Batch number 534
Batch number 535
Batch number 536
Batch number 537
Batch number 538
Batch number 539
Batch number 540
Batch number 541
Batch number 542
Batch number 543
Batch number 544
Batch number 545
Batch number 546
Batch number 547
Batch number 548
Batch number 549
Batch number 550
Batch number 551
Batch number 552
Batch number 553
Batch number 554
Batch number 555
Batch number 556
Batch number 557
Batch number 558
Batch number 559
Batch number 560
Batch number 561
Batch number 562
Batch number 563
Batch number 564
Batch number 565
Batch number 566
Batch number 567
Batch number 568
Batch number 569
Batch number 570
Batch number 571
Batch number 572
Batch number 573
Batch number 574
Batch number 575
Batch number 576
Batch number 577
Batch number 578
Batch number 579
Batch number 580
Batch number 581
Batch number 582
Batch number 583
Batch number 584
Batch number 585
Batch number 586
Batch number 587
Batch number 588
Batch number 589
Batch number 590
Batch number 591
Batch number 592
Batch number 593
Batch number 594
Batch number 595
Batch number 596
Batch number 597
Batch number 598
Batch number 599
Batch number 600
Batch number 601
Batch number 602
Batch number 603
Batch number 604
Batch number 605
Batch number 606
Batch number 607
Batch number 608
Batch number 609
Batch number 610
Batch number 611
Batch number 612
Batch number 613
Batch number 614
Batch number 615
Batch number 616
Batch number 617
Batch number 618
Batch number 619
Batch number 620
Batch number 621
Batch number 622
Batch number 623
Batch number 624
Batch number 625
Batch number 626
Batch number 627
Batch number 628
Batch number 629
Batch number 630
Batch number 631
Batch number 632
Batch number 633
Batch number 634
Batch number 635
Batch number 636
Batch number 637
Batch number 638
Batch number 639
Batch number 640
Batch number 641
Batch number 642
Batch number 643
Batch number 644
Batch number 645
Batch number 646
Batch number 647
Batch number 648
Batch number 649
Batch number 650
Batch number 651
Batch number 652
Batch number 653
Batch number 654
Batch number 655
Batch number 656
Batch number 657
Batch number 658
Batch number 659
Batch number 660
Batch number 661
Batch number 662
Batch number 663
Batch number 664
Batch number 665
Batch number 666
Batch number 667
Batch number 668
Batch number 669
Batch number 670
Batch number 671
Batch number 672
Batch number 673
Batch number 674
Batch number 675
Batch number 676
Batch number 677
Batch number 678
Batch number 679
Batch number 680
Batch number 681
Batch number 682
Batch number 683
Batch number 684
Batch number 685
Batch number 686
Batch number 687
Batch number 688
Batch number 689
Batch number 690
Batch number 691
Batch number 692
Batch number 693
Batch number 694
Batch number 695
Batch number 696
Batch number 697
Batch number 698
Batch number 699
Batch number 700
Batch number 701
Batch number 702
Batch number 703
Batch number 704
Batch number 705
Batch number 706
Batch number 707
Batch number 708
Batch number 709
Batch number 710
Batch number 711
Batch number 712
Batch number 713
Batch number 714
Batch number 715
Batch number 716
Batch number 717
Batch number 718
Batch number 719
Batch number 720
Batch number 721
Batch number 722
Batch number 723
Batch number 724
Batch number 725
Batch number 726
Batch number 727
Batch number 728
Batch number 729
Batch number 730
Batch number 731
Batch number 732
Batch number 733
Batch number 734
Batch number 735
Batch number 736
Batch number 737
Batch number 738
Batch number 739
Batch number 740
Batch number 741
Batch number 742
Batch number 743
Batch number 744
Batch number 745
Batch number 746
Batch number 747
Batch number 748
Batch number 749
Batch number 750
Batch number 751
Batch number 752
Batch number 753
Batch number 754
Batch number 755
Batch number 756
Batch number 757
Batch number 758
Batch number 759
Batch number 760
Batch number 761
Batch number 762
Batch number 763
Batch number 764
Batch number 765
Batch number 766
Batch number 767
Batch number 768
Batch number 769
Batch number 770
Batch number 771
Batch number 772
Batch number 773
Batch number 774
Batch number 775
Batch number 776
Batch number 777
Batch number 778
Batch number 779
Batch number 780
Batch number 781
Batch number 782
Batch number 783
Batch number 784
Batch number 785
Batch number 786
Batch number 787
Batch number 788
Batch number 789
Batch number 790
Batch number 791
Batch number 792
Batch number 793
Batch number 794
Batch number 795
Batch number 796
Batch number 797
Batch number 798
Batch number 799
Batch number 800
Batch number 801
Batch number 802
Batch number 803
Batch number 804
Batch number 805
Batch number 806
Batch number 807
Batch number 808
Batch number 809
Batch number 810
Batch number 811
Batch number 812
Batch number 813
Batch number 814
Batch number 815
Batch number 816
Batch number 817
Batch number 818
Batch number 819
Batch number 820
Batch number 821
Batch number 822
Batch number 823
Batch number 824
Batch number 825
Batch number 826
Batch number 827
Batch number 828
Batch number 829
Batch number 830
Batch number 831
Batch number 832
Batch number 833
Batch number 834
Batch number 835
Batch number 836
Batch number 837
Batch number 838
Batch number 839
Batch number 840
Batch number 841
Batch number 842
Batch number 843
Batch number 844
Batch number 845
Batch number 846
Batch number 847
Batch number 848
Batch number 849
Batch number 850
Batch number 851
Batch number 852
Batch number 853
Batch number 854
Batch number 855
Batch number 856
Batch number 857
Batch number 858
Batch number 859
Batch number 860
Batch number 861
Batch number 862
Batch number 863
Batch number 864
Batch number 865
Batch number 866
Batch number 867
Batch number 868
Batch number 869
Batch number 870
Batch number 871
Batch number 872
Batch number 873
Batch number 874
Batch number 875
Batch number 876
Batch number 877
Batch number 878
Batch number 879
Batch number 880
Batch number 881
Batch number 882
Batch number 883
Batch number 884
Batch number 885
Batch number 886
Batch number 887
Batch number 888
Batch number 889
Batch number 890
Batch number 891
Batch number 892
Batch number 893
Batch number 894
Batch number 895
Batch number 896
Batch number 897
Batch number 898
Batch number 899
Batch number 900
Batch number 901
Batch number 902
Batch number 903
Batch number 904
Batch number 905
Batch number 906
Batch number 907
Batch number 908
Batch number 909
Batch number 910
Batch number 911
Batch number 912
Batch number 913
Batch number 914
Batch number 915
Batch number 916
Batch number 917
Batch number 918
Batch number 919
Batch number 920
Batch number 921
Batch number 922
Batch number 923
Batch number 924
Batch number 925
Batch number 926
Batch number 927
Batch number 928
Batch number 929
Batch number 930
Batch number 931
Batch number 932
Batch number 933
Batch number 934
Batch number 935
Batch number 936
Batch number 937
Batch number 938
Batch number 939
Batch number 940
Batch number 941
Batch number 942
Batch number 943
Batch number 944
Batch number 945
Batch number 946
Batch number 947
Batch number 948
Batch number 949
Batch number 950
Batch number 951
Batch number 952
Batch number 953
Batch number 954
Batch number 955
Batch number 956
Batch number 957
Batch number 958
Batch number 959
Batch number 960
Batch number 961
Batch number 962
Batch number 963
Batch number 964
Batch number 965
Batch number 966
Batch number 967
Batch number 968
Batch number 969
Batch number 970
Batch number 971
Batch number 972
Batch number 973
Batch number 974
Batch number 975
Batch number 976
Batch number 977
Batch number 978
Batch number 979
Batch number 980
Batch number 981
Batch number 982
Batch number 983
Batch number 984
Batch number 985
Batch number 986
Batch number 987
Batch number 988
Batch number 989
Batch number 990
Batch number 991
Batch number 992
Batch number 993
Batch number 994
Batch number 995
Batch number 996
Batch number 997
Batch number 998
Batch number 999
Training time:  120.35138750076294
Training time per batch:  0.12035138750076294
BM Evaluate
{'target_3600_return_mean': 1293.0270155903436, 'target_3600_return_std': 84.75015946096983, 'target_3600_length_mean': 420.04, 'target_3600_length_std': 22.424950390134644}
evaluation time:  166.47130846977234
mean return 1293.0270155903436
std returns 84.75015946096983
mean lengths 420.04
std lengths 22.424950390134644
Evaluate
evaluation time:  134.24575543403625
mean return 912.2653580422509
std returns 28.12877487093248
mean lengths 306.86
std lengths 7.636779425909851
