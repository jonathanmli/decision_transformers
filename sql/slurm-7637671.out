Warning: Flow failed to import. Set the environment variable D4RL_SUPPRESS_IMPORT_ERROR=1 to suppress this message.
No module named 'flow'
INFO:absl:MUJOCO_GL is not set, so an OpenGL backend will be chosen automatically.
/home-nfs/doctorduality/mc3/envs/ml2/lib/python3.9/site-packages/glfw/__init__.py:906: GLFWError: (65544) b'X11: The DISPLAY environment variable is missing'
  warnings.warn(message, GLFWError)
INFO:absl:Successfully imported OpenGL backend: glfw
INFO:absl:MuJoCo library version is: 210
Warning: CARLA failed to import. Set the environment variable D4RL_SUPPRESS_IMPORT_ERROR=1 to suppress this message.
No module named 'carla'
pybullet build time: Dec  1 2021 18:34:28
/home-nfs/doctorduality/mc3/envs/ml2/lib/python3.9/site-packages/gym/spaces/box.py:73: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(
/share/data/mei-work/jolly/decision_transformers/sql/evaluation/DTevaluation.py:52: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1639180487213/work/torch/csrc/utils/tensor_new.cpp:201.)
  s = torch.tensor([env.reset()], dtype=self.dtype, device=self.device)
/share/data/mei-work/jolly/decision_transformers/sql/evaluation/DTevaluation.py:71: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  a = torch.cat((a, torch.tensor(action, dtype=self.dtype, device=self.device).reshape(1, -1)))
JJ DT Experiment with 10000 training steps, 0.0001 learning rate, 10000 warmup steps, and start seed 6
==================================================
Starting new experiment: walker2d expert
1000 trajectories, 999214 timesteps found
Average return: 4920.51, std: 136.39
Max return: 5011.69, min: 763.42
==================================================
==================================================
Iteration with seed 6
Train
Training time:  1864.6281690597534
Training time per batch:  0.18646281690597535
BM Evaluate
{'target_5000_return_mean': 4845.515699320382, 'target_5000_return_std': 509.08309377934734, 'target_5000_length_mean': 968.07, 'target_5000_length_std': 93.74041337651548}
evaluation time:  368.46474385261536
mean return 4845.515699320382
std returns 509.08309377934734
mean lengths 968.07
std lengths 93.74041337651548
4845.515699320382,509.08309377934734,968.07,93.74041337651548,6
Evaluate
evaluation time:  44.7285532951355
mean return 5.884768222910684
std returns 0.09351602789005538
mean lengths 117.24
std lengths 2.5499803920814763
5.884768222910684,0.09351602789005538,117.24,2.5499803920814763,6
==================================================
Starting new experiment: walker2d expert
1000 trajectories, 999214 timesteps found
Average return: 4920.51, std: 136.39
Max return: 5011.69, min: 763.42
==================================================
==================================================
Iteration with seed 7
Train
Training time:  1947.2674140930176
Training time per batch:  0.19472674140930177
BM Evaluate
{'target_5000_return_mean': 383.1298850330768, 'target_5000_return_std': 52.01708267652749, 'target_5000_length_mean': 127.3, 'target_5000_length_std': 12.09173271289107}
evaluation time:  60.84933829307556
mean return 383.1298850330768
std returns 52.01708267652749
mean lengths 127.3
std lengths 12.09173271289107
383.1298850330768,52.01708267652749,127.3,12.09173271289107,6
Evaluate
evaluation time:  403.5097861289978
mean return 80.23639131370034
std returns 17.79552852038691
mean lengths 877.2
std lengths 180.49581712604862
80.23639131370034,17.79552852038691,877.2,180.49581712604862,6
==================================================
Starting new experiment: walker2d expert
1000 trajectories, 999214 timesteps found
Average return: 4920.51, std: 136.39
Max return: 5011.69, min: 763.42
==================================================
==================================================
Iteration with seed 8
Train
Training time:  2205.0425968170166
Training time per batch:  0.22050425968170165
BM Evaluate
{'target_5000_return_mean': 544.8661649846239, 'target_5000_return_std': 559.1229667018398, 'target_5000_length_mean': 158.31, 'target_5000_length_std': 106.13629869182363}
evaluation time:  71.00832462310791
mean return 544.8661649846239
std returns 559.1229667018398
mean lengths 158.31
std lengths 106.13629869182363
544.8661649846239,559.1229667018398,158.31,106.13629869182363,6
Evaluate
evaluation time:  51.619483947753906
mean return 4.937905202543664
std returns 0.048182877881898865
mean lengths 112.51
std lengths 1.6881646839097186
4.937905202543664,0.048182877881898865,112.51,1.6881646839097186,6
==================================================
Starting new experiment: walker2d expert
1000 trajectories, 999214 timesteps found
Average return: 4920.51, std: 136.39
Max return: 5011.69, min: 763.42
==================================================
==================================================
Iteration with seed 9
Train
Training time:  2376.563235282898
Training time per batch:  0.2376563235282898
BM Evaluate
{'target_5000_return_mean': 1901.521620608881, 'target_5000_return_std': 1876.0225980358412, 'target_5000_length_mean': 414.24, 'target_5000_length_std': 348.3976498198574}
evaluation time:  213.78409576416016
mean return 1901.521620608881
std returns 1876.0225980358412
mean lengths 414.24
std lengths 348.3976498198574
1901.521620608881,1876.0225980358412,414.24,348.3976498198574,6
Evaluate
evaluation time:  73.86318016052246
mean return 8.77987617119167
std returns 0.4862076140216647
mean lengths 154.24
std lengths 5.3406366661663105
8.77987617119167,0.4862076140216647,154.24,5.3406366661663105,6
==================================================
Starting new experiment: walker2d expert
1000 trajectories, 999214 timesteps found
Average return: 4920.51, std: 136.39
Max return: 5011.69, min: 763.42
==================================================
==================================================
Iteration with seed 10
Train
Training time:  2161.1730060577393
Training time per batch:  0.21611730060577392
BM Evaluate
{'target_5000_return_mean': 4760.545668622413, 'target_5000_return_std': 816.501551968247, 'target_5000_length_mean': 954.83, 'target_5000_length_std': 151.74544836666436}
evaluation time:  435.6883246898651
mean return 4760.545668622413
std returns 816.501551968247
mean lengths 954.83
std lengths 151.74544836666436
4760.545668622413,816.501551968247,954.83,151.74544836666436,6
Evaluate
evaluation time:  47.0030312538147
mean return 4.762240846320713
std returns 0.03847832686766594
mean lengths 101.45
std lengths 0.8170067319184094
4.762240846320713,0.03847832686766594,101.45,0.8170067319184094,6
