Warning: Flow failed to import. Set the environment variable D4RL_SUPPRESS_IMPORT_ERROR=1 to suppress this message.
No module named 'flow'
INFO:absl:MUJOCO_GL is not set, so an OpenGL backend will be chosen automatically.
/home-nfs/doctorduality/mc3/envs/ml2/lib/python3.9/site-packages/glfw/__init__.py:906: GLFWError: (65544) b'X11: The DISPLAY environment variable is missing'
  warnings.warn(message, GLFWError)
INFO:absl:Successfully imported OpenGL backend: glfw
INFO:absl:MuJoCo library version is: 210
Warning: CARLA failed to import. Set the environment variable D4RL_SUPPRESS_IMPORT_ERROR=1 to suppress this message.
No module named 'carla'
pybullet build time: Dec  1 2021 18:34:28
/home-nfs/doctorduality/mc3/envs/ml2/lib/python3.9/site-packages/gym/spaces/box.py:73: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(
/share/data/mei-work/jolly/decision_transformers/sql/evaluation/DTevaluation.py:52: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1639180487213/work/torch/csrc/utils/tensor_new.cpp:201.)
  s = torch.tensor([env.reset()], dtype=self.dtype, device=self.device)
/share/data/mei-work/jolly/decision_transformers/sql/evaluation/DTevaluation.py:71: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  a = torch.cat((a, torch.tensor(action, dtype=self.dtype, device=self.device).reshape(1, -1)))
JJ DT Experiment with 10000 training steps, 0.0001 learning rate, 10000 warmup steps, and start seed 6
==================================================
Starting new experiment: walker2d medium
1190 trajectories, 999995 timesteps found
Average return: 2852.09, std: 1095.44
Max return: 4226.94, min: -6.61
==================================================
==================================================
Iteration with seed 6
Train
Training time:  1744.1092338562012
Training time per batch:  0.17441092338562011
BM Evaluate
{'target_5000_return_mean': 3584.5152389330206, 'target_5000_return_std': 464.48516305827906, 'target_5000_length_mean': 973.71, 'target_5000_length_std': 114.9695868480008}
evaluation time:  378.89238810539246
mean return 3584.5152389330206
std returns 464.48516305827906
mean lengths 973.71
std lengths 114.9695868480008
3584.5152389330206,464.48516305827906,973.71,114.9695868480008,6
Evaluate
evaluation time:  272.3661205768585
mean return 61.82193410531676
std returns 25.65783365465724
mean lengths 696.09
std lengths 266.33685794497165
61.82193410531676,25.65783365465724,696.09,266.33685794497165,6
==================================================
Starting new experiment: walker2d medium
1190 trajectories, 999995 timesteps found
Average return: 2852.09, std: 1095.44
Max return: 4226.94, min: -6.61
==================================================
==================================================
Iteration with seed 7
Train
Training time:  1805.3451972007751
Training time per batch:  0.1805345197200775
BM Evaluate
{'target_5000_return_mean': 2347.260694787094, 'target_5000_return_std': 1509.2409257701577, 'target_5000_length_mean': 655.22, 'target_5000_length_std': 368.74678520632557}
evaluation time:  311.6912407875061
mean return 2347.260694787094
std returns 1509.2409257701577
mean lengths 655.22
std lengths 368.74678520632557
2347.260694787094,1509.2409257701577,655.22,368.74678520632557,6
Evaluate
evaluation time:  433.6550874710083
mean return 67.50005061219949
std returns 11.421957850369697
mean lengths 921.8
std lengths 153.10231872835894
67.50005061219949,11.421957850369697,921.8,153.10231872835894,6
==================================================
Starting new experiment: walker2d medium
1190 trajectories, 999995 timesteps found
Average return: 2852.09, std: 1095.44
Max return: 4226.94, min: -6.61
==================================================
==================================================
Iteration with seed 8
Train
Training time:  2054.4486289024353
Training time per batch:  0.20544486289024352
BM Evaluate
{'target_5000_return_mean': 1808.274591938951, 'target_5000_return_std': 1620.6076650608293, 'target_5000_length_mean': 530.36, 'target_5000_length_std': 408.2718339538009}
evaluation time:  235.49122834205627
mean return 1808.274591938951
std returns 1620.6076650608293
mean lengths 530.36
std lengths 408.2718339538009
1808.274591938951,1620.6076650608293,530.36,408.2718339538009,6
Evaluate
evaluation time:  97.77536749839783
mean return 15.987384204938209
std returns 11.60416072711064
mean lengths 212.97
std lengths 102.68529154655013
15.987384204938209,11.60416072711064,212.97,102.68529154655013,6
==================================================
Starting new experiment: walker2d medium
1190 trajectories, 999995 timesteps found
Average return: 2852.09, std: 1095.44
Max return: 4226.94, min: -6.61
==================================================
==================================================
Iteration with seed 9
Train
Training time:  2067.050882101059
Training time per batch:  0.2067050882101059
BM Evaluate
{'target_5000_return_mean': 1957.640122853944, 'target_5000_return_std': 1534.9446124184908, 'target_5000_length_mean': 566.09, 'target_5000_length_std': 386.8539283760732}
evaluation time:  258.2961206436157
mean return 1957.640122853944
std returns 1534.9446124184908
mean lengths 566.09
std lengths 386.8539283760732
1957.640122853944,1534.9446124184908,566.09,386.8539283760732,6
Evaluate
evaluation time:  191.60746479034424
mean return 36.474635788112586
std returns 13.93091909024005
mean lengths 418.14
std lengths 127.79233310335954
36.474635788112586,13.93091909024005,418.14,127.79233310335954,6
==================================================
Starting new experiment: walker2d medium
1190 trajectories, 999995 timesteps found
Average return: 2852.09, std: 1095.44
Max return: 4226.94, min: -6.61
==================================================
==================================================
Iteration with seed 10
Train
Training time:  2046.217304468155
Training time per batch:  0.2046217304468155
BM Evaluate
{'target_5000_return_mean': 3478.611631626706, 'target_5000_return_std': 707.5186290461917, 'target_5000_length_mean': 934.77, 'target_5000_length_std': 174.50168222684846}
evaluation time:  425.00182366371155
mean return 3478.611631626706
std returns 707.5186290461917
mean lengths 934.77
std lengths 174.50168222684846
3478.611631626706,707.5186290461917,934.77,174.50168222684846,6
Evaluate
evaluation time:  128.16882729530334
mean return 19.37200386461087
std returns 27.689479180127577
mean lengths 282.83
std lengths 311.89116867907626
19.37200386461087,27.689479180127577,282.83,311.89116867907626,6
